<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>首页</title>
</head>
<body>
  <ul id="users"></ul>
  <script>
    // console.log('localstorage')
    window.onload = function() {
      const usersUL = document.getElementById('users');
      const users = JSON.parse(localStorage.getItem('users'));
      if (users) {
        console.log('已经缓存了');
        usersUL.innerHTML = users.map(user => `
          <li>
            ${user.username} - ${user.hometown}
          </li>
        `).join('')
        return;
      }


      //请求数据
      fetch('/users')
        .then(data => data.json())
        .then(data => {
          localStorage.setItem('users', JSON.stringify(data));//存字符串
          usersUL.innerHTML = data.map(user => `
            <li>
              ${user.username} - ${user.hometown}
            </li>
          `).join('')
        })
    }
    
  </script>
</body>
</html>